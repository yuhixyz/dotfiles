PLUGINS_DIR="~/.config/sketchybar/plugins"


# bar
sketchybar --bar height=27                                         \
                 blur_radius=50                                    \
                 position=top                                      \
                 padding_left=10                                   \
                 padding_right=10                                  \
                 color=0x44000000                                  \
                 y_offset=-2

# left
sketchybar --add item  apple left                                    \
           --set apple icon=􀣺                                        \
                       icon.font="Hack Nerd Font Mono:Regular:15.0"  \
                       label="Yunhai"                                \
                       label.font="SF Pro:Medium:13.0"               \
                       icon.padding_right=10                         \
                       icon.padding_left=10              

sketchybar --add item  vsplit left                                    \
           --set vsplit icon=">"                                      \
                        icon.font="Hack Nerd Font Mono:Regular:15.0"  \
                        icon.padding_right=10                         \
                        icon.padding_left=10              

sketchybar --add event window_focus \
           --add event title_change

sketchybar --add item title left \
           --set title script="$PLUGINS_DIR/window_title.sh" \
                       label.font="SF Mono:Medium:13.0"            \
           --subscribe title front_app_switched window_focus title_change space_change

# center
SPACE_ICONS=("1°" "2°" "3°" "4°" "5°" "6°" "7°" "8°" "9°")

for i in "${!SPACE_ICONS[@]}"
do
  sid=$(($i+1))
  sketchybar --add space space.$sid center                               \
             --set space.$sid associated_space=$sid                      \
                              icon=${SPACE_ICONS[i]}                     \
                              icon.padding_left=6                        \
                              icon.padding_right=6                       \
                              icon.font="SF Mono:Medium:13.0"            \
                              label.drawing=off                          \
                              background.padding_left=5                  \
                              background.padding_right=5                 \
                              background.color=0x44ffffff                \
                              background.corner_radius=5                 \
                              background.height=20                       \
                              background.drawing=off                     \
                              script="$PLUGINS_DIR/space.sh"             \
                              click_script="yabai -m space --focus $sid"
done


# right
sketchybar --default label.padding_left=0                                               \
                     icon.padding_right=6                                               \
                     icon.padding_left=0                                                \
                     label.padding_right=14                                             \
                     label.font="SF Pro:Medium:12"

sketchybar --add item clock right                                                       \
           --set clock update_freq=1                                                    \
                       icon=􀧞                                                           \
                       script="$PLUGINS_DIR/clock.sh"                                   
                                                                                                         
sketchybar --add item battery right                                                     \
           --set battery update_freq=30                                                 \
                         script="$PLUGINS_DIR/power.sh"

sketchybar -m --add event bluetooth_change "com.apple.bluetooth.status"                 \
              --add item headphones right                                               \
              --set headphones updates=on                                               \
                               icon=􀟥                                                   \
                               script="$PLUGINS_DIR/airpods_battery.sh"                 \
              --subscribe headphones bluetooth_change


sketchybar --add event input_change 'AppleSelectedInputSourcesChangedNotification'      \
           --add item input right                                                       \
           --set input script="$PLUGINS_DIR/input.sh"                                   \
                       label.font="SF Pro:Medium Italic:13.0"                           \
           --subscribe input input_change


# update
sketchybar --update
