#!/usr/bin/env sh

sudo yabai --load-sa
yabai -m signal --add event=dock_did_restart action="sudo yabai --load-sa"

# sketchybar events
yabai -m signal --add event=window_focused action="sketchybar -m --trigger window_focus &> /dev/null"
yabai -m signal --add event=window_title_changed action="sketchybar -m --trigger title_change &> /dev/null"

# yabai border
yabai -m config window_border               on
yabai -m config window_border_width         4
yabai -m config active_window_border_color  '0xfff6c177'
yabai -m config normal_window_border_color  '0xff908caa'

yabai -m config auto_balance on
# set focus follows mouse mode (default: off, options: off, autoraise, autofocus)
# yabai -m config focus_follows_mouse autoraise
# modify window shadows (default: on, options: on, off, float)
# example: show shadows only for floating windows
yabai -m config window_shadow float

apps='^(Safari|Firefox|IntelliJ IDEA|VimR|kitty|Google Chrome|PDF Expert|WPS Office|Code|Microsoft Word|Microsoft Excel|Microsoft PowerPoint)$'
yabai -m rule --add app!="${apps}" manage=off border=off
yabai -m rule --add app="^WPS Office$" space=2
yabai -m rule --add app="^PDF Expert$" space=2
yabai -m rule --add app="^Microsoft Word$" space=2
yabai -m rule --add app="^Microsoft Excel$" space=2
yabai -m rule --add app="^Microsoft PowerPoint$" space=2
yabai -m rule --add app="^QQ$" space=4
yabai -m rule --add app="^Mail$" space=4
yabai -m rule --add app="^WeChat$" space=4
yabai -m rule --add app="^WeCom$" space=4
yabai -m rule --add app="^YesPlayMusic$" space=5
yabai -m rule --add app="^Steam$" space=6
yabai -m rule --add app="^Firefox$" title="^Library$" manage=off border=off
yabai -m rule --add app="^Firefox$" title="^$" manage=off border=off

# window opacity
yabai -m config window_opacity on
yabai -m config active_window_opacity 1.0
yabai -m config normal_window_opacity 0.90

# general settings
yabai -m config layout                       bsp
yabai -m config top_padding                  30 
yabai -m config bottom_padding               0
yabai -m config left_padding                 5
yabai -m config right_padding                5
yabai -m config window_gap                   6

echo "yabai configuration loaded.."
